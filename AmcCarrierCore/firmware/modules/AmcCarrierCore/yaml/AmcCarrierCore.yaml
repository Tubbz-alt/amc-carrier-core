##############################################################################
## This file is part of 'LCLS2 Common Carrier Core'.
## It is subject to the license terms in the LICENSE.txt file found in the 
## top-level directory of this distribution and at: 
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html. 
## No part of 'LCLS2 Common Carrier Core', including this file, 
## may be copied, modified, propagated, or distributed except according to 
## the terms contained in the LICENSE.txt file.
##############################################################################

include: AxiVersion.yaml
include: AxiEmpty.yaml
include: AxiSysMonUltraScale.yaml
include: AxiMicronN25Q.yaml
include: AxiSy56040.yaml
include: GenericMemory.yaml
include: AmcCarrierBsi.yaml
include: AmcCarrierTiming.yaml
include: AmcCarrierBsa.yaml
include: XauiReg.yaml
include: UdpEngineWrapper.yaml
include: RssiCore.yaml

Device: &AmcCarrierCore 
  name: AmcCarrierCore
  description: AmcCarrierCore
  size: 0x80000000 # 2GB address space for core firmware
  ######### 
  IntField:
  ######### 
    - offset: 0x00000400
      name: AMC_CARRIER_CORE_VERSION_C
      mode: RO
      description: AMC Carrier Core Version Number
  ########
  MMIODev:
  ########
    - <<: *AxiVersion
      offset: 0x00000000
    ##################################################
    - <<: *AxiSysMonUltraScale
      offset: 0x01000000
    ##################################################
    - <<: *AxiMicronN25Q
      offset: 0x02000000  
    ##################################################
    - <<: *AxiSy56040
      offset: 0x03000000      
    ##################################################
    - name: "Axi24LC64FT"
      offset: 0x04000000       
      size: 0x2000       
      IntField:
        - <<: *MemoryArray
          nelms: 0x800
    ##################################################
    - name: "AxiCdcm6208"
      offset: 0x05000000       
      size: 0x40       
      IntField:
        - <<: *MemoryArray
          nelms: 0x29      
    ##################################################
    - name: "DdrSpdMemory"
      offset: 0x06000000       
      size: 0x100     
      description: Lookup tool at www.micron.com/spd
      IntField:
        - <<: *MemoryArray
          nelms: 0x40        
          nmode: RO # Read only
    ##################################################
    - name: "DdrTempSensor"
      offset: 0x06000100       
      size: 0x100     
      IntField:
        - <<: *MemoryArray
          nelms: 0x40        
          nmode: RO # Read only
    ##################################################
    - <<: *AmcCarrierBsi
      offset: 0x07000000      
    ##################################################  
    - <<: *AmcCarrierTiming
      offset: 0x08000000      
    ##################################################
    - <<: *AmcCarrierBsa
      offset: 0x09000000    
    ##################################################
    - <<: *XauiReg
      offset: 0x0A000000  
    ##################################################
    - <<: *UdpEngineWrapper
      offset: 0x0A010000 # ClientConfig[1:0]
      nelms: 2
      stride: 0x10      
    ##################################################
    - <<: *RssiCore
      name: "RssiServerSw"
      offset: 0x0A020000 # Server RSSI’s Software    
    ##################################################
    - <<: *RssiCore
      name: "RssiServerBp"
      offset: 0x0A030000 # Server RSSI’s BP_MSG[1:0]     
      nelms: 2
      stride: 0x800
    ##################################################
    - <<: *RssiCore
      name: "RssiClientBp"
      offset: 0x0A030400 # Client RSSI’s BP_MSG[1:0]    
      nelms: 2
      stride: 0x800            
    ################################################## 
    - <<: *AxiEmpty
      name: "DdrPhy"  # AxiEmpty is a placeholder
      offset: 0x0B000000      
    ##################################################   
    - <<: *AxiEmpty
      name: "MpsPhy"  # AxiEmpty is a placeholder
      offset: 0x0C000000      
    #########################################################
